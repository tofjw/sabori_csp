% TSP instance: n=5, bound=107
% Distance matrix (flattened, 1-based index: dist_flat[i*n + j + 1] = dist[i][j])

array [1..25] of int: dist_flat = [0, 82, 15, 4, 95, 82, 0, 36, 32, 29, 15, 36, 0, 18, 95, 4, 32, 18, 0, 14, 95, 29, 95, 14, 0];

var 0..4: next_0 :: output_var;
var 0..4: next_1 :: output_var;
var 0..4: next_2 :: output_var;
var 0..4: next_3 :: output_var;
var 0..4: next_4 :: output_var;

var 4..95: edge_cost_0;
var 4..95: edge_cost_1;
var 4..95: edge_cost_2;
var 4..95: edge_cost_3;
var 4..95: edge_cost_4;

var 1..5: idx_0;
var 6..10: idx_1;
var 11..15: idx_2;
var 16..20: idx_3;
var 21..25: idx_4;

var 20..107: total_cost :: output_var;

constraint circuit([next_0, next_1, next_2, next_3, next_4]);

% Index constraints: idx_i = next_i + i*n + 1
constraint int_lin_eq([1, -1], [next_0, idx_0], -1);
constraint int_lin_eq([1, -1], [next_1, idx_1], -6);
constraint int_lin_eq([1, -1], [next_2, idx_2], -11);
constraint int_lin_eq([1, -1], [next_3, idx_3], -16);
constraint int_lin_eq([1, -1], [next_4, idx_4], -21);

% Edge cost constraints: edge_cost_i = dist_flat[idx_i]
constraint array_int_element(idx_0, dist_flat, edge_cost_0);
constraint array_int_element(idx_1, dist_flat, edge_cost_1);
constraint array_int_element(idx_2, dist_flat, edge_cost_2);
constraint array_int_element(idx_3, dist_flat, edge_cost_3);
constraint array_int_element(idx_4, dist_flat, edge_cost_4);

% Total cost constraint
constraint int_lin_eq([1, 1, 1, 1, 1, -1], [edge_cost_0, edge_cost_1, edge_cost_2, edge_cost_3, edge_cost_4, total_cost], 0);

solve satisfy;
